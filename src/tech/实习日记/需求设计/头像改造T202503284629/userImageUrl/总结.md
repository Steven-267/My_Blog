---
icon: pen-to-square
date: 2025-4-18
category:
- 后端
tag:
- 实习
---
# 总结

# 1.属于杭州银行的所以需要查出对应的账户登入拿到token才有效

![image-20250403141535387](/Users/xiaoxu/Library/Application Support/typora-user-images/image-20250403141535387.png)

# 2.拿到url转成base64

------

### ✅ 一句话总结：

> **拿到图片 URL 不直接返回，而是转成 Base64 返回，是为了让前端更方便、更安全、更统一地展示图片，避免跨域、权限、资源失效等问题。**

------

### ✅ 简洁对比表：

| 方式       | 直接返回 URL             | 返回 Base64 字符串                     |
| ---------- | ------------------------ | -------------------------------------- |
| 📦 易用性   | 前端要再发一次请求       | 直接可用 `<img src="data:..." />` 显示 |
| 🔐 跨域问题 | 可能有跨域限制、鉴权失败 | 无跨域，嵌在数据里就是资源             |
| 📉 资源失效 | 链接可能过期 / 无效      | Base64 一次性传输，不依赖服务          |
| 📎 展示灵活 | 依赖网络加载             | 可离线使用，嵌入式展示                 |

```java
private String getImageBase64String(InputStream in) throws IOException
```

👉 把图片的输入流 `InputStream` 中的所有字节**读取出来**，并编码成一个 Base64 字符串返回。

------

## 🧱 核心步骤解释：

| 代码段                                    | 作用说明                        |
| ----------------------------------------- | ------------------------------- |
| `ByteArrayOutputStream buffer`            | 用来收集图片的所有字节          |
| `in.read(...)` 循环                       | 把输入流的数据一段段读进 byte[] |
| `buffer.write(...)`                       | 把每段数据写入到内存缓冲区中    |
| `buffer.toByteArray()`                    | 把整张图片数据转为 byte[] 数组  |
| `Base64.getEncoder().encodeToString(...)` | 把 byte[] 编码为 Base64 字符串  |

------

## ✅ 一句话总结：

> 这是把任何文件流转为 Base64 的标准写法，适用于图片、PDF、Excel 等一切可以转字节的文件。

------

## 🛠 封装通用工具类：

```java
public class Base64Util {

    public static String toBase64(InputStream in) throws IOException {
        ByteArrayOutputStream buffer = new ByteArrayOutputStream();
        byte[] data = new byte[1024];
        int nRead;
        while ((nRead = in.read(data, 0, data.length)) != -1) {
            buffer.write(data, 0, nRead);
        }
        return Base64.getEncoder().encodeToString(buffer.toByteArray());
    }
}
```

------


